extends layout
block content
  .container-fulid
    .col-sm-10.col-md-10
      .panel.panel-default
        .panel-heading
          .row
            .pull-right(style="margin-right: 10px;")
              h3#h3.panel-title عرض #{title}
            .col-xs-6.col-md-6
              form.form#search_family(action="")
                .input-group
                  input.form-control(type='text',name="search_name" placeholder='بحث...')
                  .input-group-btn
                    button.btn.btn-default(type="submit")
                      i.glyphicon.glyphicon-search
            .pull-left(style="margin-left: 10px;")
              a.btn.btn-success(href='#add', role='button',data-toggle='modal')
                span.glyphicon.glyphicon-plus
                span.text-none  إضافة أسرة جديدة
        .table-responsive
          table.table.table-bordred.table-striped.table-condensed
            thead
              tr.info
                th.text-center رقم الاسرة
                th.text-center رقم القيد
                th.text-center رقم ورقة العائلة
                th.text-center تاريخ فتح ورقة العائلة
                th.text-center الرقم الالي
                th.text-center حالة الاسرة
                th.text-center نوع الاسرة
                th.text-center السجل المدني
                th.text-center تعديل
                th.text-center إلغاء
            tbody
            for family in familys
              tr(id="br-#{family.id}",data-registry_number="#{family.Registrynumber}", data-record_number="#{family.Recordnumber}", data-family_record_date="#{family.FamilyRecordDate.getDate()}/#{family.FamilyRecordDate.getMonth()+1}/#{family.FamilyRecordDate.getFullYear()}", data-auto_generated_id="#{family.Autogenerated_Id}", data-is_closed="#{family.Is_Closed}", data-family_type="#{family.FamilyType}",data-officee="#{family.OfficeId}",data-office_name="#{family.Office.office_name}")
                td.text-center #{family.id}
                td.text-center #{family.Registrynumber}
                td.text-center #{family.Recordnumber}
                td.text-center #{family.FamilyRecordDate.getDate()}/ #{family.FamilyRecordDate.getMonth()+1}/ #{family.FamilyRecordDate.getFullYear()}
                td.text-center #{family.Autogenerated_Id} 
                td.text-center 
                  if family.Is_Closed == 1
                    | نشطة
                  if family.Is_Closed == 2
                    | غير نشطة
                td.text-center 
                  if family.FamilyType==1
                    |ليبية
                  else if family.FamilyType==2
                    |مؤقته
                  else if family.FamilyType==3
                    |اجانب
                td.text-center #{family.Office.office_name}
                td.text-center
                  p(data-placement="top", data-toggle="tooltip", title="تعديل")
                    button.btn.btn-primary.btn-xs.edit_btn(data-title="Edit", data-toggle="modal", data-target="#edit", value="#{family.id}")
                      span.glyphicon.glyphicon-pencil
                td.text-center
                  p(data-placement="top", data-toggle="tooltip", title="إلغاء")
                    button.btn.btn-danger.btn-xs.delete_btn(data-title="Delete", data-toggle="modal", data-target="#delete", value="#{family.id}")
                      span.glyphicon.glyphicon-trash
  #add.modal.fade(tabindex="-1", role="dialog", aria-labelledby="edit", aria-hidden="true")
    .modal-dialog
      .modal-content
        form.form#add_family_form(action="/family/new_family", method="post", accept-charset="utf-8", role="form")
          .modal-header
            button.close(type="button", data-dismiss="modal", aria-hidden="true")
              span.glyphicon.glyphicon-remove(aria-hidden="true")
            h4.modal-title.custom_align إضافة أسر ليبية جديدة
          .modal-body 

            .row 
              .col-md-6
                .form-group
                  label نوع الاسرة
                  select#FamilyType.form-control.selectpicker(name="FamilyType", data-live-search="true", data-size=5)
                    option(value="", style='color:grey; display:none;') اختر نوع الاسرة...
                    option(value="1") اسر ليبية
                    option(value="2") اسر مؤقته
                    option(value="3") اسر اجنبية
            .row
              .col-md-6
                .form-group
                  label رقم القيد
                  input#add_registry_number.form-control(type="text", name="Registrynumber", placeholder="اكتب رقم القيد")
                .form-group
                  label رقم ورقة العائلة
                  input#add_record_number.form-control(type="text", name="Recordnumber", placeholder="رقم ورقة العائلة")
                .form-group
                  label تاريخ فتح ورقة العائلة
                  input#add_family_record_date.form-control(type='text', name='FamilyRecordDate')
                  //- input#add_family_record_date.form-control(type="text", name="family_record_date", placeholder="تاريخ فتح ورقة العائلة")
              .col-md-6  
                .form-group
                  label الرقم الالي
                  input#add_auto_generated_id.form-control(type="text", name="Autogenerated_Id", placeholder="الرقم الالي")
                .form-group
                  label حالة الاسرة
                  select#is_closed.form-control.selectpicker(name="Is_Closed", data-live-search="true", data-size=5)
                    option(value="", style='color:grey; display:none;') اختر نوع الاسرة...
                    option(value="1") نشطة 
                    option(value="2") غير نشطة
                .form-group
                  label أختار السجل المدني
                  select.form-control.selectpicker(name="OfficeId", data-live-search="true", data-size=5)
                    option(value="", style='color:grey; display:none;') اختر السجل المدني...
                    for office in offices
                      option(value="#{office.id}") #{office.office_name}
          .modal-footer
            button#add_family_btn.btn.btn-warning.btn-lg(type="submit", style="width: 100%;")
              span.glyphicon.glyphicon-ok-sign
              |  إضافة
  #edit.modal.fade(tabindex="-1", role="dialog", aria-labelledby="edit", aria-hidden="true")
    .modal-dialog
      .modal-content
        form.form#edit_family_form(action="/family/edit_family", method="post", accept-charset="utf-8", role="form")
          .modal-header
            button.close(type="button", data-dismiss="modal", aria-hidden="true")
              span.glyphicon.glyphicon-remove(aria-hidden="true")
            h4.modal-title.custom_align تعديل بيانات الأسرة
          .modal-body
            .row
              .col-md-6
                .form-group
                  //- get hidden ID has family_id_edit
                  input#family_id_edit.form-control(type="hidden", name="id")
                  label رقم القيد
                  input#edit_registry_number.form-control(type="text", name="Registrynumber", placeholder="اكتب رقم القيد")
                .form-group
                  label رقم ورقة العائلة
                  input#edit_record_number.form-control(type="text", name="Recordnumber", placeholder="رقم ورقة العائلة")
                .form-group
                  label تاريخ فتح ورقة العائلة
                  input#edit_family_record_date.form-control(type="text", name="FamilyRecordDate", placeholder="تاريخ فتح ورقة العائلة")
              .col-md-6
                .form-group
                  label الرقم الالي
                  input#edit_auto_generated_id.form-control(type="text", name="Autogenerated_Id", placeholder="الرقم الالي")
                .form-group
                  label حالة الاسرة
                  select#edit_is_closed.form-control.selectpicker(type="text", name="Is_Closed", placeholder="حالة الاسرة")
                    option(value="", style='color:grey; display:none;') اختر حالة الاسرة...
                    option(value="1") نشطة 
                    option(value="2") غير نشطة
                
                .form-group
                   label نوع الاسرة
                    select#FamilyTypeEdit.form-control.selectpicker(name="FamilyType", data-live-search="true", data-size=5)
                      option(value="", style='color:grey; display:none;') اختر نوع الاسرة...
                      option(value="1") اسر ليبية
                      option(value="2") اسر مؤقته
                      option(value="3") اسر اجنبية
              .row
                .col-md-8.col-md-offset-2
                  .form-group
                    label أختار السجل المدني
                    select#edit_family_office.form-control.selectpicker(name="OfficeId", data-live-search="true", data-size=5)
                      option(value="", style='color:grey; display:none;') اختر السجل المدني...
                      for office in offices
                        option(value="#{office.id}") #{office.office_name}
          .modal-footer
            button#edit_family_btn.btn.btn-info.btn-lg(type="submit", style="width: 100%;")
              span.glyphicon.glyphicon-ok-sign
              |  تعديل
  #delete.modal.fade(tabindex="-1", role="dialog", aria-labelledby="edit", aria-hidden="true")
    .modal-dialog
      .modal-content
        form.form#delete_family_form(action="/family/delete_family", method="post", accept-charset="utf-8", role="form")
          .modal-header
            button.close(type="button", data-dismiss="modal", aria-hidden="true")
              span.glyphicon.glyphicon-remove(aria-hidden="true")
            h4.modal-title.custom_align إلغاء أسرة معين
          .modal-body
            .alert.alert-danger.h5
              //- get hidden ID has family_id_delete
              input#family_id_delete.form-control(type="hidden", name="id")               
              span.glyphicon.glyphicon-warning-sign
              |  هل تريد فعلا الغاء هذه الأسرة ؟
          .modal-footer
            button#yesBtn.btn.btn-danger(type="submit")
              span.glyphicon.glyphicon-ok-sign
              |  نعم
            button.btn.btn-default(type="button", data-dismiss="modal")
              span.glyphicon.glyphicon-remove
              |  لا
  script(src='/js/jquery-2.1.1.min.js')
  script(src='/js/bootstrap.min.js')
  script(src='/js/bootstrap-select.min.js')
  script(src='/js/jquery.validate.min.js')
  script(src='/js/bootstrap-notify.min.js')
  script(src='/js/moment-with-locales.min.js')
  script(src='/js/bootstrap-switch.min.js')
  script(src='/js/personal.js')
  script(src='/js/bootstrap-datetimepicker.min.js')
  script(src='/js/helpers.js')
  script(src='/js/family.js')
  script.
    $('#edit_family_record_date').datetimepicker({
      useCurrent: false,
      viewMode: 'years',
      format: 'YYYY-MM-DD',
      locale: 'ar-sa'
    });
    $('#add_family_record_date').datetimepicker({
      useCurrent: false,
      viewMode: 'years',
      format: 'YYYY-MM-DD',
      locale: 'ar-sa'
    });
